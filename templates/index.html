<!DOCTYPE html>
<html lang="ko">
<head>
<link rel="manifest" href="/static/manifest.json">
<meta name="theme-color" content="#ffffff">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>버스 시간 검색</title>

<style>
body {
    font-family: "Malgun Gothic", Arial;
    margin: 10px;
}

.top {
    display: flex;
    align-items: center;
    gap: 10px;
}

input[type=text] {
    width: 300px;
    height: 26px;
}

button {
    height: 30px;
}

.warning {
    color: red;
    margin: 8px 0;
}

.container {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.box {
    flex: 1;
    border: 1px solid #999;
    padding: 5px;
    max-height: 45vh;
    overflow-y: auto;
}

.box h3 {
    margin: 5px 0;
    text-align: center;
}

table {
    width: 100%;
    border-collapse: collapse;
    font-size: 14px;
}

th, td {
    border: 1px solid #ccc;
    padding: 4px;
    text-align: center;
    white-space: nowrap;
}

th {
    background-color: #f0f0f0;
}
/* 📱 모바일 최적화 */
@media (max-width: 768px) {

    body {
        margin: 6px;
        font-size: 15px;
    }

    .top {
        flex-direction: column;
        align-items: stretch;
        gap: 6px;
    }

    input[type=text] {
        width: 100%;
        height: 38px;
        font-size: 16px;
    }

    button {
        height: 40px;
        font-size: 16px;
    }

    .container {
        gap: 15px;
    }

    .box {
        padding: 6px;
        max-height: none; /* 모바일은 높이 제한 해제 */
    }

    .box h3 {
        font-size: 18px;
        margin: 8px 0;
        background: #f5f5f5;
        padding: 6px;
        border-radius: 4px;
    }

    table {
        font-size: 13px;
    }

    th, td {
        padding: 6px 4px;
    }
}

</style>
</head>

<body>

<form method="post" class="top">
    <label>정류장 이름 :</label>
    <input type="text" name="station" value="{{ station }}">
    <button type="submit">검색</button>
    <button type="button" onclick="getLocation()">📍 내 위치</button>
</form>

<div class="warning">
⚠ 도착시간은 실제 운행 상황에 따라 약 10분 정도 차이가 날 수 있습니다.
</div>

<div class="container">

<!-- 상행 -->
<div class="box">
<h3>상행</h3>
<table>
<tr>
<th>정류장</th><th>강진출발</th><th>도착</th><th>노선</th><th>코스</th>
</tr>
{% for r in up_results %}
<tr>
<td>{{ r[1] }}</td>
<td>{{ r[2] }}</td>
<td>{{ r[3] }}</td>
<td>{{ r[4] }}</td>
<td>{{ r[5] }}</td>
</tr>
{% endfor %}
</table>
</div>

<!-- 하행 -->
<div class="box">
<h3>하행</h3>
<table>
<tr>
<th>정류장</th><th>강진출발</th><th>도착</th><th>노선</th><th>코스</th>
</tr>
{% for r in down_results %}
<tr>
<td>{{ r[1] }}</td>
<td>{{ r[2] }}</td>
<td>{{ r[3] }}</td>
<td>{{ r[4] }}</td>
<td>{{ r[5] }}</td>
</tr>
{% endfor %}
</table>
</div>

</div>

<script>
function getLocation() {
    navigator.geolocation.getCurrentPosition(function(pos) {
        const form = document.createElement("form");
        form.method = "POST";
        form.action = "/";

        let lat = document.createElement("input");
        lat.type = "hidden";
        lat.name = "lat";
        lat.value = pos.coords.latitude;

        let lon = document.createElement("input");
        lon.type = "hidden";
        lon.name = "lon";
        lon.value = pos.coords.longitude;

        form.appendChild(lat);
        form.appendChild(lon);
        document.body.appendChild(form);
        form.submit();
    }, function() {
        alert("위치 정보를 가져올 수 없습니다.");
    });
}
if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("/static/sw.js");
}
</script>


</body>
</html>
